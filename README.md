# 📘 DWOJ

DWOJ 是一个基于 Node.js Express 框架开发的轻量级在线评测系统。它具备完整的题目管理、代码评测、讨论区、权限控制功能，并内置了强大的**插件系统**，支持高度的自定义扩展。

## 📋 目录
1. [安装与部署](#1-安装与部署)
2. [使用教程](#2-使用教程)
3. [插件开发指南](#3-插件编写教程)

---

## 1. 安装与部署

### 环境要求
*   **Node.js**: v14.0 或更高版本
*   **Python**: Python 3.x (用于评测 Python 代码)
*   **操作系统**: Windows / Linux / macOS 均可

### 目录结构
在开始前，请确保你的项目包含以下文件和文件夹：
```text
dwoj/
├── data/               (自动生成: 存放数据库 db.json)
├── problems_data/      (自动生成: 存放题目测试点)
├── uploads/            (自动生成: 临时文件目录)
├── plugins/            (自动生成: 插件目录)
├── public/             (静态资源)
├── views/              (EJS 页面模板)
│   └── partials/       
├── lib/                
│   └── plugin_system.js
├── app.js              (主程序)
└── package.json        (依赖配置)
```

### 安装步骤

1.  **安装依赖**
    在项目根目录下打开终端（命令行），运行：
    ```bash
    npm install
    ```

2.  **启动服务器**
    ```bash
    node app.js
    ```
    如果看到输出 `DWOJ 2.0 running on port 3000`，说明启动成功。

3.  **访问系统**
    打开浏览器访问：`http://localhost:3000`

4.  **初始化管理员账号**
    系统首次启动会自动创建超级管理员账号：
    *   **用户名**: `root`
    *   **密码**: `root`
    *   *请登录后尽快修改密码。*

---

## 2. 使用教程

### 👥 用户与权限
系统拥有三级权限体系：
1.  **Default (普通用户)**: 只能做题、查看讨论区、发帖回复、修改个人资料。
2.  **Super User (高级用户)**: 拥有管理面板权限，可以创建/编辑题目、管理插件、管理讨论节点、封禁普通用户。
3.  **Root (超级管理员)**: 系统内置账号，拥有最高权限，无法被封禁，可编辑所有题目。

### 🧩 题目管理 (仅 Super User/Root)
1.  **创建题目**:
    *   点击首页右上角的“+ 新建题目”。
    *   填写标题、描述（支持 Markdown 和 LaTeX 公式）。
    *   **测试数据**: 需要上传一个 `.zip` 压缩包。
        *   **Zip 结构要求**: 压缩包内直接包含数据文件，不要包含文件夹。
        *   文件命名: `1.in`, `1.out`, `2.in`, `2.out` ... (输入输出需一一对应)。

2.  **评测机制**:
    *   系统支持 Python 3 和 Node.js。
    *   评测机采用简单的标准输入输出比对（忽略行末空格）。

### 💬 讨论区
*   所有注册用户均可发布帖子。
*   支持 Markdown 语法（如 `**加粗**`, `[链接](url)`）。
*   支持 LaTeX 数学公式（如 `$E=mc^2$`, `$$\sum_{i=1}^n i$$`）。

### 🔌 插件管理
*   入口：登录管理员账号 -> 顶部导航栏“管理面板” -> “插件管理”。
*   功能：
    *   **上传**: 上传 `.js` 格式的插件文件。
    *   **启用/禁用**: 动态切换插件状态。注意：涉及路由（新页面）的插件启用后建议重启服务器以确保稳定。
    *   **删除**: 物理删除插件文件。

---

## 3. 插件编写教程

详见 [插件编写教程](./plugin.md)
